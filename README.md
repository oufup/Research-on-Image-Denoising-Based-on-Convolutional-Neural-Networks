# 基于卷积神经网络的图像去噪

## 项目简介

本项目研究了基于卷积神经网络（CNN）的图像去噪技术，并提出了一种结合均值滤波和深度卷积神经网络（DnCNN）的去噪模型（MFDnCNN）。该模型在去除图像噪声的同时，能够保留更多的图像细节。

## 数据集
本实验采用两个数据集，第一个数据集由12张灰度图像，图像尺寸为256*256的“Set12”数据集，是一个常用的数字图像处理数据集。第二个数据集是由Pascal VOC2012数据集中随机挑选的部分彩色图像组成，图像尺寸多样，广泛用于图像分类、目标检测等任务。
![image](https://github.com/user-attachments/assets/2db376f0-3ec0-4677-93a5-f14088b40b52)
![image](https://github.com/user-attachments/assets/52ba4dbd-1549-46bf-b928-25bf91559218)

## 步骤
为了探讨不同噪声类型及其参数对灰色及彩色图像去噪效果的影响，这里设计了一个实验，对比了DnCNN直接去噪与结合均值滤波的DnCNN去噪的效果。噪声类型包括高斯噪声、均匀噪声、白噪声、椒盐噪声和泊松噪声，它们的参数分别设置如下：高斯噪声的标准差分别为0.1、0.5、0.9，均匀噪声的范围分别为0~0.5、0.5~0.9，白噪声的标准差为0.1、0.5、0.9，椒盐噪声的椒噪声概率和盐噪声概率为0.1、0.5、0.9，泊松噪声的lam值为10、50、100。
因为要对滤波提供前置处理，本实验引入了一个均值滤波模型，该模型的滤波器大小为(3,3)，使用cv2.blur进行操作。为了追求更好的去噪效果，本实验采用了一个DnCNN模型，这个模型由17层卷积层组成，首尾各一层，其它卷积层由批量归一化和ReLU激活函数拼接而成，所有卷积核的大小均为3x3。选取均方误差（MSE）为训练的损失函数，Adm优化器为优化方法，学习率为0.01，训练25轮后保持权重。
在完成了模型的训练和加载后，对灰度图像和彩色图像分别进行了DnCNN直接去噪和MFDnCNN（均值滤波结合DnCNN）去噪的操作。以峰值信噪比（PSNR）作为模型性能的评估指标，对比并记录了所有实验的结果。


### MFDnCNN模型结构

- &zwnj;**均值滤波模块**&zwnj;：对图像进行平滑处理，减少高频噪声。
- &zwnj;**DnCNN模块**&zwnj;：采用残差学习框架，通过卷积层、批量归一化层和ReLU激活函数提取图像特征并去除噪声。
![image](https://github.com/user-attachments/assets/182198b1-6244-4751-b0bd-6b30bdaef340)

### 实验与评估

- &zwnj;**数据集**&zwnj;：Set12灰度图像数据集和Pascal VOC2012彩色图像数据集。
- &zwnj;**噪声类型**&zwnj;：高斯噪声、均匀噪声、白噪声、椒盐噪声、泊松噪声。
- &zwnj;**评估指标**&zwnj;：峰值信噪比（PSNR）。

## 使用说明

1. &zwnj;**环境配置**&zwnj;：
   - 确保已安装Python 3.x。
   - 安装必要的库：`numpy`, `opencv-python`, `pytorch`。

2. &zwnj;**运行代码**&zwnj;：
   - 下载并解压数据集。
   - 修改代码中的数据集路径和模型参数。
   - 运行`train.py`进行模型训练。
   - 运行`test.py`进行模型测试并评估去噪效果。

